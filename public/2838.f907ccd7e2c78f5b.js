"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2838],{2838:(E,_,m)=>{m.r(_),m.d(_,{ChatRoomPageModule:()=>G});var g=m(6895),r=m(433),i=m(5133),h=m(5017),d=m(655),C=m(1135),u=m(6388),t=m(4650),f=m(9846),b=m(9014);function Z(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"div",13),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.selectPhoto())}),t.qZA()}}function x(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-img",14)(1,"ion-input",15),t.NdJ("ngModelChange",function(a){t.CHM(o);const l=t.oxw();return t.KtG(l.msgImgChat.img=a)}),t.qZA()()}if(2&n){const o=t.oxw();t.Q6J("src",o.msgImgChat.img),t.xp6(1),t.Q6J("ngModel",o.msgImgChat.img)}}let I=(()=>{class n{constructor(o,e,a,l,c){this.datepipe=o,this.formBuilder=e,this.modalCtrl=a,this.uiService=l,this.chatService=c,this.nickname="",this.roomname="",this.msgImgChat={nickname:"",message:"",img:""},this.connected=this.datepipe.transform(new Date,"dd/MMMM/YYYY h:mm a")}ngOnInit(){this.nickname=localStorage.getItem("nickname"),this.chatForm=this.formBuilder.group({roomname:[this.room.roomname,r.kI.required],nickname:[this.nickname,r.kI.required],message:["",r.kI.required],img:["",r.kI.required]})}regresar(){this.modalCtrl.dismiss()}selectPhoto(){return(0,d.mG)(this,void 0,void 0,function*(){const o=yield u.V1.getPhoto({quality:75,width:400,height:400,allowEditing:!1,source:u.oK.Prompt,resultType:u.dk.DataUrl});this.isSelected=!0,this.msgImgChat.img=o.dataUrl})}addImgChat(){const{roomname:o,nickname:e,message:a,img:l}=this.chatForm.value;this.chatService.crearMsgImgChat(o,e,a,l).then(c=>{!0===c?this.regresar():this.uiService.alertaInformativaLogin("Error",c,"error")})}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g.uU),t.Y36(r.qu),t.Y36(i.IN),t.Y36(f.F),t.Y36(b.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-img-chat"]],inputs:{room:"room"},decls:21,vars:5,consts:[[1,"ion-no-border"],["color","dark"],["slot","start"],[3,"tap"],["slot","icon-only","md","arrow-back-sharp","color","light"],["slot","end"],[1,"message-form",3,"formGroup","ngSubmit"],["id","img",3,"tap",4,"ngIf"],["id","imgChat",3,"src",4,"ngIf"],["lines","none",1,"message-input"],["type","text","placeholder","Enter message here","formControlName","message"],["fill","clear","slot","end","type","submit",3,"tap"],["md","send-sharp","slot","icon-only","color","dark"],["id","img",3,"tap"],["id","imgChat",3,"src"],["type","text","formControlName","img","hidden","",3,"ngModel","ngModelChange"]],template:function(o,e){1&o&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.NdJ("tap",function(){return e.regresar()}),t._UZ(4,"ion-icon",4),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",5)(8,"ion-chip")(9,"ion-label")(10,"b"),t._uU(11),t.qZA(),t._UZ(12,"br"),t.qZA()()()()(),t.TgZ(13,"ion-content")(14,"form",6),t.NdJ("ngSubmit",function(){return e.addImgChat()}),t.YNc(15,Z,1,0,"div",7),t.YNc(16,x,2,2,"ion-img",8),t.TgZ(17,"ion-item",9),t._UZ(18,"ion-input",10),t.TgZ(19,"ion-button",11),t.NdJ("tap",function(){return e.addImgChat()}),t._UZ(20,"ion-icon",12),t.qZA()()()()),2&o&&(t.xp6(6),t.hij(" ",e.room.roomname," "),t.xp6(5),t.Oqu(e.nickname),t.xp6(3),t.Q6J("formGroup",e.chatForm),t.xp6(1),t.Q6J("ngIf",!e.isSelected),t.xp6(1),t.Q6J("ngIf",e.isSelected))},dependencies:[g.O5,r._Y,r.JJ,r.JL,i.YG,i.Sm,i.hM,i.W2,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.wd,i.sr,i.j9,r.sg,r.u],styles:["ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-dark)}ion-chip[_ngcontent-%COMP%]{font-weight:700;--background: var(--ion-color-light);--color: var(--ion-color-dark)}#img[_ngcontent-%COMP%]{width:200px;height:200px;margin:100px auto;background:url(no-imagen.29a1ada4a1eaa587.jpg)}#imgChat[_ngcontent-%COMP%]{width:200px;height:200px;margin:100px auto}.message-input[_ngcontent-%COMP%]{width:100%;border:1px solid var(--ion-color-medium);border-radius:6px;background:#fff;color:#000;resize:none;margin-top:0;--padding-start: 8px}.message-form[_ngcontent-%COMP%]{width:100%}"]}),n})();var p=m(9485);const T=["swiper"],v=["scrollElement"];function w(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-toolbar",14)(1,"ion-buttons",15)(2,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.backButtonClickImgMsgChat())}),t._UZ(3,"ion-icon",17),t.qZA(),t.TgZ(4,"div",18),t._uU(5),t.ALo(6,"async"),t.qZA()(),t.TgZ(7,"ion-title"),t._uU(8," DeleteImgMsgChat "),t.qZA(),t.TgZ(9,"ion-buttons",19)(10,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.removeSelectedImgMsgChat())}),t._UZ(11,"ion-icon",20),t.qZA()()()}if(2&n){const o=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,1,o.msgImgChatItemCount))}}function k(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-toolbar",14)(1,"ion-buttons",15)(2,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.backButtonClickMsgChat())}),t._UZ(3,"ion-icon",17),t.qZA(),t.TgZ(4,"div",18),t._uU(5),t.ALo(6,"async"),t.qZA()(),t.TgZ(7,"ion-title"),t._uU(8," DeleteMsgChat "),t.qZA(),t.TgZ(9,"ion-buttons",19)(10,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.removeSelectedMsgChat())}),t._UZ(11,"ion-icon",20),t.qZA()()()}if(2&n){const o=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,1,o.msgChatItemCount))}}function A(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-toolbar",21)(1,"ion-buttons",15)(2,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.regresar())}),t._UZ(3,"ion-icon",22),t.qZA()(),t.TgZ(4,"ion-chip"),t._uU(5),t._UZ(6,"br"),t._uU(7),t.qZA()()}if(2&n){const o=t.oxw();t.xp6(5),t.hij(" ",o.nickname,""),t.xp6(2),t.hij(" ",o.connected," ")}}function U(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-toolbar",21)(1,"ion-title"),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons",19)(4,"ion-button",23),t.NdJ("tap",function(){const l=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.selectPhoto(l))}),t._UZ(5,"ion-icon",24),t.qZA()()()}if(2&n){const o=s.$implicit;t.xp6(2),t.hij(" ",o.roomname," ")}}const q=function(n){return{"selected-msgChat":n}},M=function(n,s){return{"my-message":n,"other-message":s}};function P(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-row",25),t.NdJ("press",function(){const l=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.selectMsgChat(l.id))}),t.TgZ(1,"ion-col",26)(2,"b"),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"b"),t._uU(6),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"b",27),t._uU(9),t.ALo(10,"date"),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"span"),t._uU(13),t.qZA()()()}if(2&n){const o=s.$implicit,e=t.oxw();t.Q6J("ngClass",t.VKq(10,q,e.selectedMsgChat===o.id)),t.xp6(1),t.Q6J("offset",o.message?3:0)("ngClass",t.WLB(12,M,o.message,!o.message)),t.xp6(2),t.Oqu(o.roomname),t.xp6(3),t.Oqu(o.nickname),t.xp6(3),t.Oqu(t.xi3(10,7,o.created,"short")),t.xp6(4),t.Oqu(o.message)}}const J=function(n){return{"selected-msgimgChat":n}};function y(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-row",25),t.NdJ("press",function(){const l=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.selectImgMsgChat(l.id))}),t.TgZ(1,"ion-col",26)(2,"b"),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"b"),t._uU(6),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"b",27),t._uU(9),t.ALo(10,"date"),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"ion-img",28),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.setOpen(!0))}),t.qZA(),t.TgZ(13,"span"),t._uU(14),t.qZA()()()}if(2&n){const o=s.$implicit,e=t.oxw();t.Q6J("ngClass",t.VKq(11,J,e.selectedImgMsgChat===o.id)),t.xp6(1),t.Q6J("offset",o.message?3:0)("ngClass",t.WLB(13,M,o.message,!o.message)),t.xp6(2),t.Oqu(o.roomname),t.xp6(3),t.Oqu(o.nickname),t.xp6(3),t.Oqu(t.xi3(10,8,o.created,"short")),t.xp6(3),t.s9C("src",o.img),t.xp6(2),t.Oqu(o.message)}}function R(n,s){if(1&n&&(t.TgZ(0,"div",40),t._UZ(1,"img",41),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.s9C("src",o.img,t.LSH)}}function Y(n,s){1&n&&t.YNc(0,R,2,1,"ng-template",39)}function O(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"ion-header",0)(1,"ion-toolbar",29)(2,"ion-buttons",15)(3,"ion-button",16),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.setOpen(!1))}),t._UZ(4,"ion-icon",17),t.qZA()(),t.TgZ(5,"ion-chip")(6,"ion-label")(7,"b"),t._uU(8),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"b"),t._uU(11),t.ALo(12,"date"),t.qZA()()()()(),t.TgZ(13,"ion-content",29)(14,"div",30)(15,"swiper",31,32),t.YNc(17,Y,1,0,null,33),t.qZA()()(),t.TgZ(18,"ion-footer")(19,"ion-row")(20,"ion-col",34)(21,"ion-button",35),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.zoom(!1))}),t._UZ(22,"ion-icon",36),t._uU(23," Out "),t.qZA()(),t.TgZ(24,"ion-col",34)(25,"ion-button",35),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.setOpen(!1))}),t._uU(26," Close "),t._UZ(27,"ion-icon",37),t.qZA()(),t.TgZ(28,"ion-col",34)(29,"ion-button",35),t.NdJ("tap",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.zoom(!0))}),t._UZ(30,"ion-icon",38),t._uU(31," In "),t.qZA()()()()}if(2&n){const o=t.oxw();t.xp6(8),t.Oqu(o.nickname),t.xp6(3),t.Oqu(t.xi3(12,4,o.connected,"short")),t.xp6(4),t.Q6J("config",o.config),t.xp6(2),t.Q6J("ngForOf",o.msgImgChats)}}const S=[{path:"",component:(()=>{class n{constructor(o,e,a,l,c,Q,B,K,z,H){this.datepipe=o,this.router=e,this.cd=a,this.route=l,this.formBuilder=c,this.navCtrl=Q,this.alertCtrl=B,this.modalCtrl=K,this.uiService=z,this.chatService=H,this.camaro=[],this.nickname="",this.roomname="",this.message="",this.msgChat={message:"",created:this.datepipe.transform(new Date,"dd/MMMM/YYYY h:mm a")},this.deleteMsgChat=!1,this.msgChatItemCount=new C.X(0),this.msgImgChat={message:"",img:""},this.isModalOpen=!1,this.config={zoom:{maxRatio:10,minRatio:.2}},this.deleteImgMsgChat=!1,this.msgImgChatItemCount=new C.X(0),this.connected=this.datepipe.transform(new Date,"dd/MMMM/YYYY h:mm a")}ngOnInit(){this.loadRooms(),this.loadMsgChats(),this.loadMsgImgChat(),this.nickname=localStorage.getItem("nickname"),this.roomname=this.route.snapshot.params.roomname,this.chatForm=this.formBuilder.group({roomname:[this.roomname,r.kI.required],nickname:[this.nickname,r.kI.required],message:["",r.kI.required]})}regresar(){this.navCtrl.navigateBack("/tabs/chat/room-list")}updateScroll(){setTimeout(()=>{this.content.scrollToBottom()},1500)}loadRooms(){this.chatService.getRooms().subscribe(o=>{this.rooms=o,console.log(o)},o=>{console.log(o)})}onFormSubmit(){const{roomname:o,nickname:e,message:a}=this.chatForm.value;this.chatService.crearMsgChat(o,e,a),this.loadMsgChats(),this.chatForm.reset()}loadMsgChats(){this.chatService.getMsgChats().subscribe(o=>{this.msgChats=o,console.log(o)},o=>{console.log(o)})}clearMsgChat(){this.selectedMsgChat=null}selectMsgChat(o){this.deleteMsgChat=!0,this.selectedMsgChat===o?this.clearMsgChat():this.selectedMsgChat=o,this.addMsgChatToolbar(this.msgChat)}addMsgChatToolbar(o){let e=!1;for(let a of this.camaro)if(a.id===o.id){a.amount+=1,e=!0;break}e||(o.amount=1,this.camaro.push(o)),this.msgChatItemCount.next(this.msgChatItemCount.value+1)}removeSelectedMsgChat(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Warning!!!",message:"You want to delete the message??",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirmado Cancelar: blah"),this.backButtonClickMsgChat()}},{text:"OK",handler:()=>{console.log("Confirmado Aceptar"),this.chatService.deleteMsgChat(this.selectedMsgChat).subscribe(e=>{this.clearMsgChat(),this.loadMsgChats(),this.backButtonClickMsgChat(),this.uiService.presentToast("Deleted message of the chat")},e=>{console.log(e)})}}]})).present()})}backButtonClickMsgChat(){this.clearMsgChat(),this.deleteMsgChat=!1}setOpen(o){this.isModalOpen=o}ngAfterContentChecked(){this.swiper&&this.swiper.updateSwiper({})}zoom(o){const e=this.swiper.swiperRef.zoom;o?e.in():e.out()}selectPhoto(o){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.modalCtrl.create({mode:"md",backdropDismiss:!0,cssClass:"modal-imgChat",componentProps:{room:o},component:I})).present()})}loadMsgImgChat(){this.chatService.getMsgImgChats().subscribe(o=>{console.log(o),this.msgImgChats=o,this.cd.detectChanges()})}clearImgMsgChat(){this.selectedImgMsgChat=null}selectImgMsgChat(o){this.deleteImgMsgChat=!0,this.selectedImgMsgChat===o?this.clearImgMsgChat():this.selectedImgMsgChat=o,this.addImgMsgChatToolbar(this.msgImgChat)}addImgMsgChatToolbar(o){let e=!1;for(let a of this.camaro)if(a.id===o.id){a.amount+=1,e=!0;break}e||(o.amount=1,this.camaro.push(o)),this.msgImgChatItemCount.next(this.msgImgChatItemCount.value+1)}removeSelectedImgMsgChat(){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Warning!!!",message:"You want to delete the image??",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirmado Cancelar: blah"),this.backButtonClickMsgChat()}},{text:"OK",handler:()=>{console.log("Confirmado Aceptar"),this.chatService.deleteMsgImgChat(this.selectedImgMsgChat).subscribe(e=>{this.clearImgMsgChat(),this.loadMsgImgChat(),this.backButtonClickImgMsgChat(),this.uiService.presentToast("Deleted message of the chat")},e=>{console.log(e)})}}]})).present()})}backButtonClickImgMsgChat(){this.clearImgMsgChat(),this.deleteImgMsgChat=!1}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g.uU),t.Y36(h.F0),t.Y36(t.sBO),t.Y36(h.gz),t.Y36(r.qu),t.Y36(i.SH),t.Y36(i.Br),t.Y36(i.IN),t.Y36(f.F),t.Y36(b.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-chat-room"]],viewQuery:function(o,e){if(1&o&&(t.Gf(T,5),t.Gf(v,5)),2&o){let a;t.iGM(a=t.CRH())&&(e.swiper=a.first),t.iGM(a=t.CRH())&&(e.content=a.first)}},decls:19,vars:10,consts:[[1,"ion-no-border"],["color","tertiary",4,"ngIf"],["color","primary",4,"ngIf"],["color","primary",4,"ngFor","ngForOf"],[1,"fondoChat",3,"scrollEvents"],["scrollElement",""],[3,"ngClass","press",4,"ngFor","ngForOf"],[3,"isOpen"],["color","light"],[1,"message-form",3,"formGroup","ngSubmit"],["lines","none",1,"message-input"],["type","text","placeholder","Enter message here","formControlName","message"],["fill","clear","slot","end","type","submit",3,"disabled"],["md","send-sharp","slot","icon-only","color","dark"],["color","tertiary"],["slot","start"],[3,"tap"],["color","light","slot","icon-only","md","arrow-back-sharp"],[1,"camaro-length"],["slot","end"],["color","light","slot","icon-only","md","trash-sharp"],["color","primary"],["slot","icon-only","md","arrow-back-sharp","color","light"],["fill","clear",3,"tap"],["md","camera-sharp","slot","icon-only","color","light"],[3,"ngClass","press"],["size","9",1,"message",3,"offset","ngClass"],[1,"time"],[1,"imgChat",3,"src","tap"],["color","dark"],[1,"fondoImgUser"],[3,"config"],["swiper",""],[4,"ngFor","ngForOf"],["size","4",1,"ion-text-center"],["fill","clear","color","light",1,"miBoton",3,"tap"],["md","remove-sharp","slot","start"],["md","close-sharp","slot","start"],["md","add-sharp","slot","start"],["swiperSlide",""],[1,"swiper-zoom-container"],[3,"src"]],template:function(o,e){1&o&&(t.TgZ(0,"ion-header",0),t.YNc(1,w,12,3,"ion-toolbar",1),t.YNc(2,k,12,3,"ion-toolbar",1),t.YNc(3,A,8,2,"ion-toolbar",2),t.YNc(4,U,6,1,"ion-toolbar",3),t.qZA(),t.TgZ(5,"ion-content",4,5)(7,"ion-grid"),t.YNc(8,P,14,15,"ion-row",6),t.YNc(9,y,15,16,"ion-row",6),t.qZA(),t.TgZ(10,"ion-modal",7),t.YNc(11,O,32,7,"ng-template"),t.qZA()(),t.TgZ(12,"ion-footer",0)(13,"ion-toolbar",8)(14,"form",9),t.NdJ("ngSubmit",function(){return e.onFormSubmit()}),t.TgZ(15,"ion-item",10),t._UZ(16,"ion-input",11),t.TgZ(17,"ion-button",12),t._UZ(18,"ion-icon",13),t.qZA()()()()()),2&o&&(t.xp6(1),t.Q6J("ngIf",e.deleteImgMsgChat),t.xp6(1),t.Q6J("ngIf",e.deleteMsgChat),t.xp6(1),t.Q6J("ngIf",!e.deleteMsgChat==!e.deleteImgMsgChat),t.xp6(1),t.Q6J("ngForOf",e.rooms),t.xp6(1),t.Q6J("scrollEvents",!0),t.xp6(3),t.Q6J("ngForOf",e.msgChats),t.xp6(1),t.Q6J("ngForOf",e.msgImgChats),t.xp6(1),t.Q6J("isOpen",e.isModalOpen),t.xp6(4),t.Q6J("formGroup",e.chatForm),t.xp6(3),t.Q6J("disabled",!e.chatForm.valid))},dependencies:[g.mk,g.sg,g.O5,r._Y,r.JJ,r.JL,i.YG,i.Sm,i.hM,i.wI,i.W2,i.fr,i.jY,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.Nd,i.wd,i.sr,i.ki,i.j9,p.nF,p.YC,r.sg,r.u,g.Ov,g.uU],styles:["ion-chip{font-weight:700;--background: var(--ion-color-dark);--color: var(--ion-color-light)}.fondoChat{--padding-start: 30%;--background: url(fondoChat.0eb04bf68c0df0c9.jpg) 0 0/100% 100% no-repeat}.message-input{width:100%;border:1px solid var(--ion-color-medium);border-radius:6px;background:#fff;color:#000;resize:none;margin-top:0;--padding-start: 8px}.message{border-radius:10px!important;margin-top:5px!important;margin-bottom:5px!important;--padding-start: 20px}.my-message{color:#fff;background:var(--ion-color-primary)}.other-message{background:var(--ion-color-danger);color:#fff}.time{font-size:small}.imgChat{padding-top:20px}.swiper{width:100%;height:400px}.swiper-slide{display:flex;flex-direction:column;align-items:center;justify-content:center}ion-footer{background:var(--ion-color-dark)}\n"],encapsulation:2}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(S),h.Bz]}),n})();var N=m(5642);let G=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[g.uU],imports:[g.ez,r.u5,i.Pc,F,p.kz,N.K,r.UX]}),n})()}}]);